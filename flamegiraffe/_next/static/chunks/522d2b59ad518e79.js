(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var t=e.i(43476),l=e.i(71645);function s({data:e,width:s=1200,height:a=600}){let[r,n]=(0,l.useState)(e),[i,o]=(0,l.useState)(null),d=(0,l.useMemo)(()=>{let e=[],t=r.value;if(0===t)return[];let l=s/t;return!function t(s,a,r){let n=s.value*l;if(n<1)return;e.push({x:a,y:16*r,width:n,height:15,node:s,color:function(e){if("root"===e||"all"===e)return"#ddd";let t=0;for(let l=0;l<e.length;l++)t=e.charCodeAt(l)+((t<<5)-t);let l=Math.abs(t)%360;return`hsl(${l}, 70%, 60%)`}(s.name)});let i=a;for(let e of s.children)t(e,i,r+1),i+=e.value*l}(r,0,0),e},[r,s]);return(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)("div",{className:"p-2 bg-gray-100 rounded text-sm h-12 flex items-center",children:i?(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"font-bold",children:i.name}),(0,t.jsxs)("span",{className:"ml-2 text-gray-600",children:["(",i.value.toLocaleString()," samples, ",(i.value/e.value*100).toFixed(2),"%)"]})]}):(0,t.jsx)("span",{className:"text-gray-400",children:"Hover over a block to see details"})}),(0,t.jsxs)("div",{className:"relative border border-gray-300 overflow-hidden",style:{width:s,height:a},children:[r!==e&&(0,t.jsx)("button",{onClick:()=>n(e),className:"absolute top-2 left-2 z-10 bg-white/90 border px-2 py-1 text-xs rounded hover:bg-gray-100",children:"Reset Zoom"}),(0,t.jsx)("svg",{width:s,height:a,className:"block",children:d.map((e,l)=>(0,t.jsxs)("g",{children:[(0,t.jsxs)("title",{children:[e.node.name," (",e.node.value,")"]}),(0,t.jsx)("rect",{x:e.x,y:a-e.y-e.height,width:e.width,height:e.height,fill:e.color,className:"hover:opacity-80 cursor-pointer transition-opacity",onClick:()=>n(e.node),onMouseEnter:()=>o(e.node),onMouseLeave:()=>o(null)})]},l))})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:'Click a frame to zoom in. Click "Reset Zoom" to reset.'})]})}function a(){let[e,a]=(0,l.useState)(null),[r,n]=(0,l.useState)(!1),[i,o]=(0,l.useState)(""),d=(0,l.useRef)(null),c=(0,l.useCallback)(()=>{i&&(n(!0),setTimeout(()=>{try{let e=function(e){let t={name:"root",value:0,children:[]};for(let l of e.split(/\r?\n/)){let e=l.trim();if(!e)continue;let s=e.lastIndexOf(" ");if(-1===s)continue;let a=e.substring(0,s),r=parseInt(e.substring(s+1),10);if(isNaN(r))continue;let n=a.split(";"),i=t;for(let e of(i.value+=r,n)){if(!e)continue;let t=i.children.find(t=>t.name===e);t||(t={name:e,value:0,children:[]},i.children.push(t)),i=t,i.value+=r}}return function e(t){t.children.sort((e,t)=>e.name.localeCompare(t.name)),t.children.forEach(e)}(t),t}(i);a(e)}catch(e){console.error(e),alert("Failed to parse data")}finally{n(!1)}},10))},[i]);return(0,t.jsxs)("div",{className:"min-h-screen bg-white p-8 font-sans text-gray-900",children:[(0,t.jsxs)("header",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight mb-2",children:"Flamegraph Explorer"}),(0,t.jsxs)("p",{className:"text-gray-500",children:["Paste your folded stack traces (Ex: ",(0,t.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:"func;child 10"}),") below or upload a file."]})]}),e?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("button",{onClick:()=>a(null),className:"text-sm text-gray-600 hover:text-black underline",children:"â† Upload new data"}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Total samples: ",e.value.toLocaleString()]})]}),(0,t.jsx)("div",{className:"border rounded-xl shadow-sm p-4 bg-white overflow-hidden",children:(0,t.jsx)(s,{data:e,width:1200,height:600})})]}):(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("input",{type:"file",onChange:e=>{let t=e.target.files?.[0];if(!t)return;let l=new FileReader;l.onload=e=>{"string"==typeof e.target?.result&&o(e.target.result)},l.readAsText(t)},className:"hidden",id:"file-upload"}),(0,t.jsx)("label",{htmlFor:"file-upload",className:"cursor-pointer inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",children:"Upload File"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-gray-400",children:"or paste content below"})]}),(0,t.jsx)("div",{children:(0,t.jsx)("textarea",{ref:d,className:"w-full h-64 p-4 border rounded-xl font-mono text-sm bg-gray-50 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"root;child;grandchild 100 root;child;sibling 50...",value:i,onChange:e=>o(e.target.value)})}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{onClick:c,disabled:!i||r,className:"px-6 py-2 bg-black text-white rounded-lg font-medium hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition",children:r?"Processing...":"Generate Flamegraph"})})]})]})}e.s(["default",()=>a],31713)}]);